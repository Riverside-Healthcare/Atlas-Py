"use strict";!function(){var e=function(e){for(var t,n=parseInt(e,10),r=7;r;)(t=Math.pow(10,3*r--))<=n&&(n=Math.round(1*n/t)/1+"kMGTPE"[r]);return n},t=function(e,t){for(var n=Number(e).toFixed(Number(t)),r=Math.trunc(n),a=e<0?1:0,i=String(Math.abs(n-r).toFixed(Number(t))).slice(2,2+Number(t)),s=String(r),o=s.length,c="";(o-=3)>a;)c=","+s.slice(o,3)+c;return s.slice(0,Math.max(0,o+3))+c+(i?"."+i:"")},n=function(n){n.classList.add("loaded");var r=null,a=new Chart(n.getContext("2d"),{type:"bar",options:{tooltips:{position:"nearest",mode:"label"},animation:{duration:300},hover:{animationDuration:0},responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!1,legend:{display:!0,position:"bottom",userPointStyle:!0},title:{display:!1},scales:{yAxes:[{id:"1",ticks:{beginAtZero:!0,callback:function(t){return e(t)}},stacked:!1,type:"linear",position:"left"},{id:"2",ticks:{beginAtZero:!0,callback:function(e){return Math.round(10*e)/10+"s"}},stacked:!1,type:"linear",position:"right"},],xAxes:[{stacked:!0,gridLines:{display:!1}},]}}});A(),h();var i=require("date-fns"),s=i.addHours,o=i.addDays,c=i.addYears,d=i.startOfDay,l=i.startOfWeek,u=i.startOfMonth,p=i.startOfYear,f=i.endOfDay,$=i.endOfWeek,y=i.endOfMonth,v=i.endOfYear,m=i.differenceInSeconds;function E(e){void 0===e&&(e=""),(document.querySelectorAll(".filters[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))})}function b(e){void 0===e&&(e=""),(document.querySelectorAll(".profile[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))})}function h(t){void 0===t&&(t=void 0),(document.querySelectorAll('.bar-data-wrapper.profile[data-url][data-target="'+n.id+'"]')||[]).forEach(function(n){n.style.opacity=".5",void 0!==t&&n.setAttribute("data-parameters",t.replace("?","&"));var r=new XMLHttpRequest;r.open("get",n.dataset.url+(n.dataset.parameters||"").replace("?","&"),!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.setRequestHeader("X-CSRFToken",csrftoken),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(),r.addEventListener("load",function(){n.innerHTML="",n.append(function(t){if(t.length>0){var n=document.createElement("table");n.classList.add("table","is-no-border","is-fullwidth","bar","sort");var r=document.createElement("tr"),a="date_title"in t[0]?"<th>"+t[0].date_title+"</th>":"";return r.innerHTML="<tr><th>"+t[0].title_one+"</th>"+a+'<th class="is-narrow">'+t[0].title_two+"</th></tr>",n.append(r),t.forEach(function(r){var a=document.createElement("tr"),i=r.href?'<a href="'+r.href+'">'+r.key+"</a>":r.key,s="date_title"in t[0]?"date"in r?"<td>"+r.date+"</td>":"<td></td>":"";a.innerHTML='<td class="is-middle">'+i+"</td>"+s+'<td class="is-narrow has-text-right"><strong class="mr-2">'+e(r.count)+"</strong>",r.percent&&(a.innerHTML+='<div class="bar-percent py-2 is-relative has-text-centered"><div class="bar-percent-fill" style="width:'+100*r.percent+'%"></div><span><strong class="has-text-grey-light">'+Math.round(100*r.percent)+"%</strong></span>"),a.innerHTML+="</td>",n.append(a)}),n}return document.createElement("span")}(JSON.parse(r.responseText))),n.style.visibility="visible",n.style.opacity="1",document.dispatchEvent(new CustomEvent("ajax"))})})}function A(i){void 0===i&&(i=void 0),n.style.opacity=".5";var s=document.querySelector("#"+n.id+"-runs"),o=document.querySelector("#"+n.id+"-users"),c=document.querySelector("#"+n.id+"-run-time");s.style.opacity=".5",o.style.opacity=".5",c.style.opacity=".5",null!==r&&r.abort(),void 0===i?i="":(n.dataset.url.includes("?")&&(i=i.replace("?","&")),n.setAttribute("data-parameters",i)),(r=new XMLHttpRequest).open("get",n.dataset.url+(n.dataset.parameters||""),!0),r.setRequestHeader("X-CSRFToken",csrftoken),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(),r.addEventListener("load",function(){var i=JSON.parse(r.responseText);s?(s.textContent=e(i.runs),s.parentElement.setAttribute("data-tooltip",""+t(i.runs,0)+" runs")):s.parentElement.removeAttribute("data-tooltip"),o?(o.textContent=e(i.users),o.parentElement.setAttribute("data-tooltip",""+t(i.users,0)+" users")):o.parentElement.removeAttribute("data-tooltip"),c?(c.textContent=i.run_time,c.parentElement.setAttribute("data-tooltip",""+t(i.run_time,2)+" seconds")):c.parentElement.removeAttribute("data-tooltip"),a.data=i.data,a.update(),n.style.opacity="1",s.style.opacity="1",o.style.opacity="1",c.style.opacity="1"})}document.querySelectorAll('.dropdown.is-select[data-target="'+n.id+'"] .dropdown-item').forEach(function(e){return e.addEventListener("click",function(e){(e.target.closest(".dropdown").querySelectorAll(".dropdown-item.is-active")||[]).forEach(function(e){e.classList.remove("is-active")}),e.target.classList.add("is-active");var t,n=e.target.closest(".dropdown.is-select .dropdown-item");n.closest(".dropdown").querySelector(".select-value").textContent=n.textContent;var r=new Date;switch(n.dataset.range){case"3":t="?start_at="+m(l(r,-24),r)+"&end_at="+m($(r),r);break;case"4":t="?start_at="+m(d(o(r,-7)),r)+"&end_at=0";break;case"5":t="?start_at="+m(u(r),r)+"&end_at="+m(y(r),r);break;case"6":t="?start_at="+m(d(o(r,-30)),r)+"&end_at=0";break;case"7":t="?start_at="+m(d(o(r,-90)),r)+"&end_at=0";break;case"8":t="?start_at="+m(p(r),r)+"&end_at="+m(v(r),r);break;case"9":t="?start_at="+m(c(r,-10),r)+"&end_at=0";break;case"10":break;case"1":t="?start_at="+m(d(s(r,-24)),r)+"&end_at="+m(f(s(r,-24)),r);break;default:t="?start_at="+m(c(r,-1),r)+"&end_at=0"}A(t),h(t),b(t),E(t)})}),document.addEventListener("click",function(e){if(e.target.closest(".profile-filter input[type=checkbox]")){var t=e.target.closest(".profile-filter input[type=checkbox]"),r=t.checked?n.dataset.parameters+"&"+t.dataset.filter:n.dataset.parameters.replace("&"+t.dataset.filter,"");A(r),E(r),h(r)}})},r=function(e){var t=e.getBoundingClientRect();return t.top>=-600&&t.left>=0&&t.bottom-e.clientHeight-600<=(document.documentElement.clientHeight||document.documentElement.clientHeight)&&t.right-600-e.clientWidth<=(document.documentElement.clientWidth||document.documentElement.clientWidth)&&null!==e.offsetParent},a=0;function i(){if(300===a)return!1;"undefined"==typeof Chart?setTimeout(function(){a++,i()},100):(a=0,(document.querySelectorAll(".profile.chart-wrapper > canvas:not(.loaded)")||[]).forEach(function(e){r(e.closest(".profile.chart-wrapper"))&&new n(e)}))}i(),document.addEventListener("ajax",function(){setTimeout(function(){i()},0)}),document.addEventListener("modal-open",function(){i()}),document.addEventListener("tab-opened",function(){i()}),document.addEventListener("scroll",function(){debounce(i(),100)},{passive:!0})}()