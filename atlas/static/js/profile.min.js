"use strict";!function(){var e=function(e){for(var t,n=parseInt(e,10),a=7;a;)(t=Math.pow(10,3*a--))<=n&&(n=Math.round(1*n/t)/1+"kMGTPE"[a]);return n},t=function(e,t){for(var n=Number(e).toFixed(Number(t)),a=Math.trunc(n),r=e<0?1:0,c=String(Math.abs(n-a).toFixed(Number(t))).slice(2,2+Number(t)),i=String(a),o=i.length,s="";(o-=3)>r;)s=","+i.slice(o,3)+s;return i.slice(0,Math.max(0,o+3))+s+(c?"."+c:"")},n=function(n){n.classList.add("loaded");var a=null,r=new Chart(n.getContext("2d"),{type:"bar",options:{tooltips:{position:"nearest",mode:"label"},animation:{duration:300},hover:{animationDuration:0},responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!1,legend:{display:!0,position:"bottom",userPointStyle:!0},title:{display:!1},scales:{yAxes:[{id:"1",ticks:{beginAtZero:!0,callback:function(t){return e(t)}},stacked:!1,type:"linear",position:"left"},{id:"2",ticks:{beginAtZero:!0,callback:function(e){return Math.round(10*e)/10+"s"}},stacked:!1,type:"linear",position:"right"},],xAxes:[{stacked:!0,gridLines:{display:!1}},]}}});g(),b();var c=require("date-fns"),i=c.addHours,o=c.addDays,s=c.addYears,l=c.startOfDay,d=c.startOfWeek,u=c.startOfMonth,$=c.startOfYear,p=c.endOfDay,f=c.endOfWeek,v=c.endOfMonth,y=c.endOfYear,m=c.differenceInSeconds;function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(document.querySelectorAll(".filters[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(document.querySelectorAll(".profile[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))})}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;(document.querySelectorAll('.bar-data-wrapper.profile[data-url][data-target="'.concat(n.id,'"]'))||[]).forEach(function(n){n.style.opacity=".5",void 0!==t&&n.setAttribute("data-parameters",t.replace("?","&"));var a=new XMLHttpRequest;a.open("get",n.dataset.url+(n.dataset.parameters||"").replace("?","&"),!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.setRequestHeader("X-CSRFToken",csrftoken),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(),a.addEventListener("load",function(){n.innerHTML="",n.append(function(t){if(t.length>0){var n=document.createElement("table");n.classList.add("table","is-no-border","is-fullwidth","bar","sort");var a=document.createElement("tr"),r="date_title"in t[0]?"<th>".concat(t[0].date_title,"</th>"):"";return a.innerHTML="<tr><th>".concat(t[0].title_one,"</th>").concat(r,'<th class="is-narrow">').concat(t[0].title_two,"</th></tr>"),n.append(a),t.forEach(function(a){var r=document.createElement("tr"),c=a.href?'<a href="'.concat(a.href,'">').concat(a.key,"</a>"):a.key,i="date_title"in t[0]?"date"in a?"<td>".concat(a.date,"</td>"):"<td></td>":"";r.innerHTML='<td class="is-middle">'.concat(c,"</td>").concat(i,'<td class="is-narrow has-text-right"><strong class="mr-2">').concat(e(a.count),"</strong>"),a.percent&&(r.innerHTML+='<div class="bar-percent py-2 is-relative has-text-centered"><div class="bar-percent-fill" style="width:'.concat(100*a.percent,'%"></div><span><strong class="has-text-grey-light">').concat(Math.round(100*a.percent),"%</strong></span>")),r.innerHTML+="</td>",n.append(r)}),n}return document.createElement("span")}(JSON.parse(a.responseText))),n.style.visibility="visible",n.style.opacity="1",document.dispatchEvent(new CustomEvent("ajax"))})})}function g(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;n.style.opacity=".5";var i=document.querySelector("#".concat(n.id,"-runs")),o=document.querySelector("#".concat(n.id,"-users")),s=document.querySelector("#".concat(n.id,"-run-time"));i.style.opacity=".5",o.style.opacity=".5",s.style.opacity=".5",null!==a&&a.abort(),void 0===c?c="":(n.dataset.url.includes("?")&&(c=c.replace("?","&")),n.setAttribute("data-parameters",c)),(a=new XMLHttpRequest).open("get",n.dataset.url+(n.dataset.parameters||""),!0),a.setRequestHeader("X-CSRFToken",csrftoken),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(),a.addEventListener("load",function(){var c=JSON.parse(a.responseText);i?(i.textContent=e(c.runs),i.parentElement.setAttribute("data-tooltip","".concat(t(c.runs,0)," runs"))):i.parentElement.removeAttribute("data-tooltip"),o?(o.textContent=e(c.users),o.parentElement.setAttribute("data-tooltip","".concat(t(c.users,0)," users"))):o.parentElement.removeAttribute("data-tooltip"),s?(s.textContent=c.run_time,s.parentElement.setAttribute("data-tooltip","".concat(t(c.run_time,2)," seconds"))):s.parentElement.removeAttribute("data-tooltip"),r.data=c.data,r.update(),n.style.opacity="1",i.style.opacity="1",o.style.opacity="1",s.style.opacity="1"})}document.querySelectorAll('.dropdown.is-select[data-target="'.concat(n.id,'"] .dropdown-item')).forEach(function(e){return e.addEventListener("click",function(e){(e.target.closest(".dropdown").querySelectorAll(".dropdown-item.is-active")||[]).forEach(function(e){e.classList.remove("is-active")}),e.target.classList.add("is-active");var t,n=e.target.closest(".dropdown.is-select .dropdown-item");n.closest(".dropdown").querySelector(".select-value").textContent=n.textContent;var a=new Date;switch(n.dataset.range){case"3":t="?start_at="+m(d(a,-24),a)+"&end_at="+m(f(a),a);break;case"4":t="?start_at="+m(l(o(a,-7)),a)+"&end_at=0";break;case"5":t="?start_at="+m(u(a),a)+"&end_at="+m(v(a),a);break;case"6":t="?start_at="+m(l(o(a,-30)),a)+"&end_at=0";break;case"7":t="?start_at="+m(l(o(a,-90)),a)+"&end_at=0";break;case"8":t="?start_at="+m($(a),a)+"&end_at="+m(y(a),a);break;case"9":t="?start_at="+m(s(a,-10),a)+"&end_at=0";break;case"10":break;case"1":t="?start_at="+m(l(i(a,-24)),a)+"&end_at="+m(p(i(a,-24)),a);break;default:t="?start_at="+m(s(a,-1),a)+"&end_at=0"}g(t),b(t),h(t),E(t)})}),document.addEventListener("click",function(e){if(e.target.closest(".profile-filter input[type=checkbox]")){var t=e.target.closest(".profile-filter input[type=checkbox]"),a=t.checked?n.dataset.parameters+"&".concat(t.dataset.filter):n.dataset.parameters.replace("&".concat(t.dataset.filter),"");g(a),E(a),b(a)}})},a=function(e){var t=e.getBoundingClientRect();return t.top>=-600&&t.left>=0&&t.bottom-e.clientHeight-600<=(document.documentElement.clientHeight||document.documentElement.clientHeight)&&t.right-600-e.clientWidth<=(document.documentElement.clientWidth||document.documentElement.clientWidth)&&null!==e.offsetParent},r=0;function c(){if(300===r)return!1;"undefined"==typeof Chart?setTimeout(function(){r++,c()},100):(r=0,(document.querySelectorAll(".profile.chart-wrapper > canvas:not(.loaded)")||[]).forEach(function(e){a(e.closest(".profile.chart-wrapper"))&&new n(e)}))}c(),document.addEventListener("ajax",function(){setTimeout(function(){c()},0)}),document.addEventListener("modal-open",function(){c()}),document.addEventListener("tab-opened",function(){c()}),document.addEventListener("scroll",function(){debounce(c(),100)},{passive:!0})}()