"use strict";!function(){var t=function(t){for(var e,a=parseInt(t,10),n=7;n;)(e=Math.pow(10,3*n--))<=a&&(a=Math.round(1*a/e)/1+"kMGTPE"[n]);return a},e=function(t,e){for(var a=Number(t).toFixed(Number(e)),n=Math.trunc(a),r=t<0?1:0,o=String(Math.abs(a-n).toFixed(Number(e))).slice(2,2+Number(e)),s=String(n),i=s.length,d="";(i-=3)>r;)d=","+s.slice(i,3)+d;return s.slice(0,Math.max(0,i+3))+d+(o?"."+o:"")},a=function(a){a.classList.add("loaded");var n=null,r=new Chart(a.getContext("2d"),{type:"bar",options:{tooltips:{position:"nearest",mode:"label"},animation:{duration:300},hover:{animationDuration:0},responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!1,legend:{display:!0,position:"bottom",userPointStyle:!0},title:{display:!1},scales:{yAxes:[{id:"1",ticks:{beginAtZero:!0,callback:function(e){return t(e)}},stacked:!1,type:"linear",position:"left"},{id:"2",ticks:{beginAtZero:!0,callback:function(t){return Math.round(10*t)/10+"s"}},stacked:!1,type:"linear",position:"right"},],xAxes:[{stacked:!0,gridLines:{display:!1}},]}}});g(),E();var o=require("date-fns"),s=o.addHours,i=o.addDays,d=o.addYears,c=o.startOfDay,l=o.startOfWeek,u=o.startOfMonth,p=o.startOfYear,m=o.endOfDay,f=o.endOfWeek,h=o.endOfMonth,v=o.endOfYear,y=o.differenceInSeconds;function b(t){void 0===t&&(t=""),(document.querySelectorAll(".filters[data-url]")||[]).forEach(function(e){e.setAttribute("data-parameters",t),e.dispatchEvent(new CustomEvent("reload"))})}function E(e){void 0===e&&(e=void 0),(document.querySelectorAll('.bar-data-wrapper.profile[data-url][data-target="'+a.id+'"]')||[]).forEach(function(a){a.style.opacity=".5",void 0!==e&&a.setAttribute("data-parameters",e.replace("?","&"));var n=new XMLHttpRequest;n.open("get",a.dataset.url+(a.dataset.parameters||"").replace("?","&"),!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("X-CSRFToken",csrftoken),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(),n.addEventListener("load",function(){a.innerHTML="",a.append(function(e){if(e.length>0){var a=document.createElement("table");a.classList.add("table","is-no-border","is-fullwidth","bar","sort");var n=document.createElement("tr"),r="date_title"in e[0]?"<th>"+e[0].date_title+"</th>":"";return n.innerHTML="<tr><th>"+e[0].title_one+"</th>"+r+'<th class="is-narrow">'+e[0].title_two+"</th></tr>",a.append(n),e.forEach(function(n){var r=document.createElement("tr"),o=n.href?'<a href="'+n.href+'">'+n.key+"</a>":n.key,s="date_title"in e[0]?"date"in n?"<td>"+n.date+"</td>":"<td></td>":"";r.innerHTML='<td class="is-middle">'+o+"</td>"+s+'<td class="is-narrow has-text-right"><strong class="mr-2">'+t(n.count)+"</strong>",n.percent&&(r.innerHTML+='<div class="bar-percent py-2 is-relative has-text-centered"><div class="bar-percent-fill" style="width:'+100*n.percent+'%"></div><span><strong class="has-text-grey-light">'+Math.round(100*n.percent)+"%</strong></span>"),r.innerHTML+="</td>",a.append(r)}),a}return document.createElement("span")}(JSON.parse(n.responseText))),a.style.visibility="visible",a.style.opacity="1",document.dispatchEvent(new CustomEvent("ajax"))})})}function g(o){void 0===o&&(o=void 0),a.style.opacity=".5";var s=document.querySelector("#"+a.id+"-runs"),i=document.querySelector("#"+a.id+"-users"),d=document.querySelector("#"+a.id+"-run-time");s.style.opacity=".5",i.style.opacity=".5",d.style.opacity=".5",null!==n&&n.abort(),void 0===o?o="":(a.dataset.url.includes("?")&&(o=o.replace("?","&")),a.setAttribute("data-parameters",o)),(n=new XMLHttpRequest).open("get",a.dataset.url+(a.dataset.parameters||""),!0),n.setRequestHeader("X-CSRFToken",csrftoken),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(),n.addEventListener("load",function(){var o=JSON.parse(n.responseText);s?(s.textContent=t(o.runs),s.parentElement.setAttribute("data-tooltip",""+e(o.runs,0)+" runs")):s.parentElement.removeAttribute("data-tooltip"),i?(i.textContent=t(o.users),i.parentElement.setAttribute("data-tooltip",""+e(o.users,0)+" users")):i.parentElement.removeAttribute("data-tooltip"),d?(d.textContent=o.run_time,d.parentElement.setAttribute("data-tooltip",""+e(o.run_time,2)+" seconds")):d.parentElement.removeAttribute("data-tooltip"),r.data=o.data,r.update(),a.style.opacity="1",s.style.opacity="1",i.style.opacity="1",d.style.opacity="1"})}document.querySelectorAll('.dropdown.is-select[data-target="'+a.id+'"] .dropdown-item').forEach(function(t){return t.addEventListener("click",function(t){(t.target.closest(".dropdown").querySelectorAll(".dropdown-item.is-active")||[]).forEach(function(t){t.classList.remove("is-active")}),t.target.classList.add("is-active");var e,a,n=t.target.closest(".dropdown.is-select .dropdown-item");n.closest(".dropdown").querySelector(".select-value").textContent=n.textContent;var r=new Date;switch(n.dataset.range){case"3":a="?start_at="+y(l(r,-24),r)+"&end_at="+y(f(r),r);break;case"4":a="?start_at="+y(c(i(r,-7)),r)+"&end_at=0";break;case"5":a="?start_at="+y(u(r),r)+"&end_at="+y(h(r),r);break;case"6":a="?start_at="+y(c(i(r,-30)),r)+"&end_at=0";break;case"7":a="?start_at="+y(c(i(r,-90)),r)+"&end_at=0";break;case"8":a="?start_at="+y(p(r),r)+"&end_at="+y(v(r),r);break;case"9":a="?start_at="+y(d(r,-10),r)+"&end_at=0";break;case"10":break;case"1":a="?start_at="+y(c(s(r,-24)),r)+"&end_at="+y(m(s(r,-24)),r);break;default:a="?start_at="+y(d(r,-1),r)+"&end_at=0"}g(a),E(a),void 0===(e=a)&&(e=""),(document.querySelectorAll(".profile[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))}),b(a)})}),document.addEventListener("click",function(t){if(t.target.closest(".profile-filter input[type=checkbox]")){var e=t.target.closest(".profile-filter input[type=checkbox]"),n=e.checked?a.dataset.parameters+"&"+e.dataset.filter:a.dataset.parameters.replace("&"+e.dataset.filter,"");g(n),b(n),E(n)}})},n=function(t){var e=t.getBoundingClientRect();return e.top>=-600&&e.left>=0&&e.bottom-t.clientHeight-600<=(document.documentElement.clientHeight||document.documentElement.clientHeight)&&e.right-600-t.clientWidth<=(document.documentElement.clientWidth||document.documentElement.clientWidth)&&null!==t.offsetParent},r=0;function o(){if(300===r)return!1;"undefined"==typeof Chart?setTimeout(function(){r++,o()},100):(r=0,(document.querySelectorAll(".profile.chart-wrapper > canvas:not(.loaded)")||[]).forEach(function(t){n(t.closest(".profile.chart-wrapper"))&&new a(t)}))}o(),document.addEventListener("ajax",function(){setTimeout(function(){o()},0)}),document.addEventListener("modal-open",function(){o()}),document.addEventListener("tab-opened",function(){o()}),document.addEventListener("scroll",function(){debounce(o(),100)},{passive:!0})}();