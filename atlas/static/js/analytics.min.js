"use strict";!function(){var e=function(e){for(var t,a=parseInt(e,10),r=7;r;)(t=Math.pow(10,3*r--))<=a&&(a=Math.round(1*a/t)/1+"kMGTPE"[r]);return a},t=function(t){if(t.length>0){var a=document.createElement("table");a.classList.add("table","is-no-border","is-fullwidth","bar");var r=document.createElement("tr");return r.innerHTML="<tr><th>"+t[0].title_one+'</th><th class="is-narrow">'+t[0].title_two+"</th></tr>",a.append(r),t.forEach(function(t){var r=document.createElement("tr"),n=t.href?'<a href="'+t.href+'">'+t.key+"</a>":t.key;r.innerHTML='<td class="is-middle">'+n+'</td><td class="is-narrow has-text-right"><strong class="mr-2">'+e(t.count)+"</strong>",t.percent&&(r.innerHTML+='<div class="bar-percent py-2 is-relative has-text-centered"><div class="bar-percent-fill" style="width:'+100*t.percent+'%"></div><span><strong class="has-text-grey-light">'+Math.round(100*t.percent)+"%</strong></span>"),r.innerHTML+="</td>",a.append(r)}),a}return document.createElement("span")},a=function(e){void 0===e&&(e=""),(document.querySelectorAll(".analytics[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))})},r=function(e){void 0===e&&(e=""),(document.querySelectorAll(".bar-data-wrapper.analytics[data-url]")||[]).forEach(function(a){a.style.opacity=".5";var r=new XMLHttpRequest;r.open("get",a.dataset.url+e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("X-CSRFToken",csrftoken),r.send(),r.addEventListener("load",function(){a.innerHTML="",a.append(t(JSON.parse(r.responseText))),a.style.visibility="visible",a.style.opacity="1"})})},n=function(t){void 0===t&&(t=""),s.style.opacity=".5";var a=document.querySelector("#analytics-views"),r=document.querySelector("#analytics-visitors"),n=document.querySelector("#analytics-load-time");a.style.opacity=".5",r.style.opacity=".5",n.style.opacity=".5",null!==o&&o.abort(),s.dataset.url.includes("?")&&(t=t.replace("?","&")),(o=new XMLHttpRequest).open("get",s.dataset.url+t,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("X-CSRFToken",csrftoken),o.send(),o.addEventListener("load",function(){var t=JSON.parse(o.responseText);a&&(a.textContent=e(t.views)),r&&(r.textContent=e(t.visitors)),n&&(n.textContent=t.load_time),window.visitsChart.data=t.data,window.visitsChart.update(),s.style.opacity="1",a.style.opacity="1",r.style.opacity="1",n.style.opacity="1"})},s=document.querySelector("#visits-chart"),o=null,i={type:"bar",options:{tooltips:{position:"nearest",mode:"label"},animation:{duration:300},hover:{animationDuration:0},responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!1,legend:{display:!0,position:"bottom",userPointStyle:!0},title:{display:!1},scales:{yAxes:[{id:"1",ticks:{beginAtZero:!0,callback:function(t){return e(t)}},stacked:!1,type:"linear",position:"left"},{id:"2",ticks:{beginAtZero:!0,callback:function(e){return Math.round(10*e)/10+"s"}},stacked:!1,type:"linear",position:"right"},],xAxes:[{stacked:!0,gridLines:{display:!1}},]}}},c=document.querySelector("#visits-chart").getContext("2d"),l=function(){window.visitsChart=new Chart(c,i),n(),r();var e=require("date-fns"),t=e.addHours,s=e.addDays,o=e.addYears,l=e.startOfDay,d=e.startOfWeek,u=e.startOfMonth,f=e.startOfYear,y=e.endOfDay,p=e.endOfWeek,v=e.endOfMonth,$=e.endOfYear,h=e.differenceInSeconds;document.querySelectorAll('.dropdown.is-select[data-target="views-chart"] .dropdown-item').forEach(function(e){return e.addEventListener("click",function(e){(e.target.closest(".dropdown").querySelectorAll(".dropdown-item.is-active")||[]).forEach(function(e){e.classList.remove("is-active")}),e.target.classList.add("is-active");var i,c=e.target.closest(".dropdown.is-select .dropdown-item");c.closest(".dropdown").querySelector(".select-value").textContent=c.textContent;var q=new Date;switch(c.dataset.range){case"1":i="?start_at="+h(l(q),q)+"&end_at="+h(y(q),q);break;case"3":i="?start_at="+h(d(q,-24),q)+"&end_at="+h(p(q),q);break;case"4":i="?start_at="+h(l(s(q,-7)),q)+"&end_at=0";break;case"5":i="?start_at="+h(u(q),q)+"&end_at="+h(v(q),q);break;case"6":i="?start_at="+h(l(s(q,-30)),q)+"&end_at=0";break;case"7":i="?start_at="+h(l(s(q,-90)),q)+"&end_at=0";break;case"8":i="?start_at="+h(f(q),q)+"&end_at="+h($(q),q);break;case"9":i="?start_at="+h(o(q,-10),q)+"&end_at=0";break;case"10":break;default:i="?start_at="+h(t(q,-24),q)+"&end_at=0"}n(i),r(i),a(i)})})};document.addEventListener("click",function(e){if((e.target.matches('.trace-resolved[type="checkbox"]')||e.target.matches('.error-resolved[type="checkbox"]'))&&"INPUT"===e.target.tagName){var t=e.target,a=1;t.hasAttribute("checked")?(t.removeAttribute("checked"),a=2,t.closest("tr.has-text-grey-light").classList.remove("has-text-grey-light"),(t.closest("tr").querySelectorAll("a.has-text-grey-light")||[]).forEach(function(e){e.classList.remove("has-text-grey-light")}),(t.closest("tr").querySelectorAll("div.notification")||[]).forEach(function(e){e.classList.add("is-danger")})):(t.setAttribute("checked","checked"),t.closest("tr").classList.add("has-text-grey-light"),(t.closest("tr").querySelectorAll("a")||[]).forEach(function(e){e.classList.add("has-text-grey-light")}),(t.closest("tr").querySelectorAll("div.notification.is-danger")||[]).forEach(function(e){e.classList.remove("is-danger")}));var r={Id:t.dataset.id,Type:a},n=Object.keys(r).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r[e])}).join("&"),s=new XMLHttpRequest;s.open("post",t.dataset.url+"?handler=Resolved&"+n,!0),s.setRequestHeader("Content-Type","text/html;charset=UTF-8`"),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-CSRFToken",csrftoken),s.send()}});var d=0;!function e(){if(300===d)return!1;"undefined"==typeof Chart?setTimeout(function(){d++,e()},100):(d=0,l())}()}()