"use strict";!function(){var e=function(e){for(var t,a=parseInt(e,10),n=7;n;)(t=Math.pow(10,3*n--))<=a&&(a=Math.round(1*a/t)/1+"kMGTPE"[n]);return a},t=function(t){if(t.length>0){var a=document.createElement("table");a.classList.add("table","is-no-border","is-fullwidth","bar");var n=document.createElement("tr");return n.innerHTML="<tr><th>".concat(t[0].title_one,'</th><th class="is-narrow">').concat(t[0].title_two,"</th></tr>"),a.append(n),t.forEach(function(t){var n=document.createElement("tr"),r=t.href?'<a href="'.concat(t.href,'">').concat(t.key,"</a>"):t.key;n.innerHTML='<td class="is-middle">'.concat(r,'</td><td class="is-narrow has-text-right"><strong class="mr-2">').concat(e(t.count),"</strong>"),t.percent&&(n.innerHTML+='<div class="bar-percent py-2 is-relative has-text-centered"><div class="bar-percent-fill" style="width:'.concat(100*t.percent,'%"></div><span><strong class="has-text-grey-light">').concat(Math.round(100*t.percent),"%</strong></span>")),n.innerHTML+="</td>",a.append(n)}),a}return document.createElement("span")},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(document.querySelectorAll(".analytics[data-url]")||[]).forEach(function(t){t.setAttribute("data-parameters",e),t.dispatchEvent(new CustomEvent("reload"))})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(document.querySelectorAll(".bar-data-wrapper.analytics[data-url]")||[]).forEach(function(a){a.style.opacity=".5";var n=new XMLHttpRequest;n.open("get",a.dataset.url+e,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("X-CSRFToken",csrftoken),n.send(),n.addEventListener("load",function(){a.innerHTML="",a.append(t(JSON.parse(n.responseText))),a.style.visibility="visible",a.style.opacity="1"})})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";s.style.opacity=".5";var a=document.querySelector("#analytics-views"),n=document.querySelector("#analytics-visitors"),r=document.querySelector("#analytics-load-time");a.style.opacity=".5",n.style.opacity=".5",r.style.opacity=".5",null!==o&&o.abort(),s.dataset.url.includes("?")&&(t=t.replace("?","&")),(o=new XMLHttpRequest).open("get",s.dataset.url+t,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("X-CSRFToken",csrftoken),o.send(),o.addEventListener("load",function(){var t=JSON.parse(o.responseText);a&&(a.textContent=e(t.views)),n&&(n.textContent=e(t.visitors)),r&&(r.textContent=t.load_time),window.visitsChart.data=t.data,window.visitsChart.update(),s.style.opacity="1",a.style.opacity="1",n.style.opacity="1",r.style.opacity="1"})},s=document.querySelector("#visits-chart"),o=null,c={type:"bar",options:{tooltips:{position:"nearest",mode:"label"},animation:{duration:300},hover:{animationDuration:0},responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!1,legend:{display:!0,position:"bottom",userPointStyle:!0},title:{display:!1},scales:{yAxes:[{id:"1",ticks:{beginAtZero:!0,callback:function(t){return e(t)}},stacked:!1,type:"linear",position:"left"},{id:"2",ticks:{beginAtZero:!0,callback:function(e){return Math.round(10*e)/10+"s"}},stacked:!1,type:"linear",position:"right"},],xAxes:[{stacked:!0,gridLines:{display:!1}},]}}},i=document.querySelector("#visits-chart").getContext("2d"),l=function(){window.visitsChart=new Chart(i,c),r(),n();var e=require("date-fns"),t=e.addHours,s=e.addDays,o=e.addYears,l=e.startOfDay,d=e.startOfWeek,u=e.startOfMonth,f=e.startOfYear,y=e.endOfDay,p=e.endOfWeek,$=e.endOfMonth,v=e.endOfYear,h=e.differenceInSeconds;document.querySelectorAll('.dropdown.is-select[data-target="views-chart"] .dropdown-item').forEach(function(e){return e.addEventListener("click",function(e){(e.target.closest(".dropdown").querySelectorAll(".dropdown-item.is-active")||[]).forEach(function(e){e.classList.remove("is-active")}),e.target.classList.add("is-active");var c,i=e.target.closest(".dropdown.is-select .dropdown-item");i.closest(".dropdown").querySelector(".select-value").textContent=i.textContent;var q=new Date;switch(i.dataset.range){case"1":c="?start_at="+h(l(q),q)+"&end_at="+h(y(q),q);break;case"3":c="?start_at="+h(d(q,-24),q)+"&end_at="+h(p(q),q);break;case"4":c="?start_at="+h(l(s(q,-7)),q)+"&end_at=0";break;case"5":c="?start_at="+h(u(q),q)+"&end_at="+h($(q),q);break;case"6":c="?start_at="+h(l(s(q,-30)),q)+"&end_at=0";break;case"7":c="?start_at="+h(l(s(q,-90)),q)+"&end_at=0";break;case"8":c="?start_at="+h(f(q),q)+"&end_at="+h(v(q),q);break;case"9":c="?start_at="+h(o(q,-10),q)+"&end_at=0";break;case"10":break;default:c="?start_at="+h(t(q,-24),q)+"&end_at=0"}r(c),n(c),a(c)})})};document.addEventListener("click",function(e){if((e.target.matches('.trace-resolved[type="checkbox"]')||e.target.matches('.error-resolved[type="checkbox"]'))&&"INPUT"===e.target.tagName){var t=e.target,a=1;t.hasAttribute("checked")?(t.removeAttribute("checked"),a=2,t.closest("tr.has-text-grey-light").classList.remove("has-text-grey-light"),(t.closest("tr").querySelectorAll("a.has-text-grey-light")||[]).forEach(function(e){e.classList.remove("has-text-grey-light")}),(t.closest("tr").querySelectorAll("div.notification")||[]).forEach(function(e){e.classList.add("is-danger")})):(t.setAttribute("checked","checked"),t.closest("tr").classList.add("has-text-grey-light"),(t.closest("tr").querySelectorAll("a")||[]).forEach(function(e){e.classList.add("has-text-grey-light")}),(t.closest("tr").querySelectorAll("div.notification.is-danger")||[]).forEach(function(e){e.classList.remove("is-danger")}));var n={Id:t.dataset.id,Type:a},r=Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&"),s=new XMLHttpRequest;s.open("post",t.dataset.url+"?handler=Resolved&"+r,!0),s.setRequestHeader("Content-Type","text/html;charset=UTF-8`"),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-CSRFToken",csrftoken),s.send()}});var d=0;!function e(){if(300===d)return!1;"undefined"==typeof Chart?setTimeout(function(){d++,e()},100):(d=0,l())}()}()